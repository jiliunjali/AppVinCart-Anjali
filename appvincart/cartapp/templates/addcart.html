{% extends 'base.html' %}
{% load static %}

{% block title %}
    Add to Cart
{% endblock %}

{% block content %}
    <div class="container mt-5">
        <h1>Add to Cart</h1>

        <form id="add-to-cart-form" method="post">
            {% csrf_token %}
            <label for="user_id">User ID:</label>
            <input type="text" id="user_id" name="user_id">
            <br>
            <label for="product_id">Product ID:</label>
            <input type="text" id="product_id" name="product_id">
            <br>
            <label for="quantity">Quantity:</label>
            <input type="number" id="quantity" name="quantity" value="1">
            <br>
            <button type="submit" id="add-to-cart-btn">Add to Cart</button>
        </form>

        <div id="message-box" style="display: none;"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('add-to-cart-form').addEventListener('submit', function (event) {
                event.preventDefault(); // Prevent the form from submitting
    
                var formData = new FormData(this);
                var user_id = formData.get('user_id');
                var product_id = formData.get('product_id');
                var quantity = formData.get('quantity') || 1; // default to 1
    
                fetch(`/cart/addtocart/${user_id}/${product_id}/`, { // Pass user_id and product_id in the URL
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    // Display message box with the response message
                    var messageBox = document.getElementById('message-box');
                    messageBox.innerText = data.message;
                    messageBox.style.display = 'block';
    
                    // Hide the message box after 3 seconds
                    setTimeout(function () {
                        messageBox.style.display = 'none';
                    }, 3000);
                })
                .catch(error => console.error('Error:', error));
            });
        });
    </script>
    
{% endblock %}


{% comment %} {% extends 'base.html' %}
{% load static %}

{% block title %}
    Add to Cart
{% endblock %}

{% block content %}
    <div class="container mt-5">
        <h1>Add to Cart</h1>

        {% if message %}
            <p>{{ message }}</p>
        {% else %}
            <form method="post">
                {% csrf_token %}
                <label for="user_id">User ID:</label>
                <input type="text" id="user_id" name="user_id">
                <br>
                <label for="product_id">Product ID:</label>
                <input type="text" id="product_id" name="product_id">
                <br>
                <label for="quantity">Quantity:</label>
                <input type="number" id="quantity" name="quantity" value="1">
                <br>
                <button type="submit">Add to Cart</button>
            </form>
        {% endif %}
    </div>
{% endblock %} {% endcomment %}
